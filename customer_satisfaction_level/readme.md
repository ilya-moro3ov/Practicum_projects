# Проект: построение моделей для прогноза и предсказания его увольнения из компании

HR-аналитики компании «Работа с заботой» помогают бизнесу оптимизировать управление персоналом: бизнес предоставляет данные, а аналитики предлагают, как избежать финансовых потерь и оттока сотрудников. В этом HR-аналитикам пригодится машинное обучение, с помощью которого получится быстрее и точнее отвечать на вопросы бизнеса. Компания предоставила данные с характеристиками сотрудников компании. Среди них — уровень удовлетворённости сотрудника работой в компании. Эту информацию получили из форм обратной связи: сотрудники заполняют тест-опросник, и по его результатам рассчитывается доля их удовлетворённости от 0 до 1, где 0 — совершенно неудовлетворён, 1 — полностью удовлетворён. Собирать данные такими опросниками не так легко: компания большая, и всех сотрудников надо сначала оповестить об опросе, а затем проследить, что все его прошли.

## Цель исследования

1. Построить модель, которая сможет предсказать уровень удовлетворённости сотрудника на основе данных заказчика.

Почему бизнесу это важно: удовлетворённость работой напрямую влияет на отток сотрудников. А предсказание оттока — одна из важнейших задач HR-аналитиков. Внезапные увольнения несут в себе риски для компании, особенно если уходит важный сотрудник.

2. Построить модель, которая сможет на основе данных заказчика предсказать то, что сотрудник уволится из компании.

## Ход исследования

**Задача 1: предсказание уровня удовлетворённости сотрудника**

1. Загрузка данных.
2. Предобработка данных: изучим данные и сделаем выводы. При необходимости выполним предобработку. Если есть пропуски, заполним их в пайплайне.
3. Исследовательский анализ данных: исследуем все признаки и сделаем выводы о том, как их нужно подготовить.
4. Подготовка данных: выполним в пайплайне, дополнив пайплайн шага предобработки. При кодировании учитем особенности признаков и моделей и используем как минимум два кодировщика.
5. Обучение моделей: обучите как минимум две модели. Возьмем одну линейную модель, а в качестве второй — дерево решений. Подберем гиперпараметры как минимум для одной модели с помощью одного из известных инструментов. Выберим лучшую модель и проверим её качество. Выбор сделаем на основе новой метрики — SMAPE (англ. symmetric mean absolute percentage error, «симметричное среднее абсолютное процентное отклонение»). Напишим функцию, которая принимает на вход массивы NumPy или объекты Series в pandas и возвращает значение метрики SMAPE. Используем эту метрику при подборе гиперпараметров и оценке качества моделей. Критерий успеха: SMAPE ≤15 на тестовой выборке. В решении сохраним работу со всеми моделями, которые опробовали. Сделаем выводы.
6. Оформление выводов: сделаем промежуточные выводы о том, какая модель справилась лучше и почему.

**Задача 2: предсказание увольнения сотрудника из компании**

1. Загрузка данных.
2. Предобработка данных: изучим данные и при необходимости выполним предобработку. Если есть пропуски, заполним их в пайплайне.
3. Исследовательский анализ данных:
- Проведем исследовательский анализ данных.
- Составим портрет «уволившегося сотрудника». (Например, можно узнать, в каком отделе с большей вероятностью работает уволившийся сотрудник и какой у него уровень загруженности. Также можно сравнить среднее значение зарплаты ушедших сотрудников с теми, кто остался в компании).
- Проверим утверждение аналитиков, что уровень удовлетворённости сотрудника работой в компании влияет на то, уволится ли сотрудник: визуализируем и сравним распределения признака job_satisfaction_rate для ушедших и оставшихся сотрудников. Используем данные с обоими целевыми признаками тестовой выборки.
4. Добавление нового входного признака: допустим, job_satisfaction_rate и quit действительно связаны и мы получили необходимое значение метрики в первой задаче. Тогда добавим job_satisfaction_rate, предсказанный лучшей моделью первой задачи, к входным признакам второй задачи.
5. Подготовка данных: подготовим признаки так же, как и в первой задаче: выполним подготовку в пайплайне, дополнив пайплайн предобработки. При кодировании учитем особенности признаков и моделей и используем как минимум два кодировщика.
6. Обучение модел: обучим как минимум три модели. Как минимум для двух из них подберем гиперпараметры. Проверим качество лучшей модели. Метрика оценки качества в этой задаче — ROC-AUC. Критерий успеха: ROC-AUC ≥0.91 на тестовой выборке. Важно: отбор признаков часто помогает улучшить метрику.
7. Выводы: сделаем промежуточные выводы о том, какая модель справилась лучше и почему.

**Общий вывод**

- опишим задачу;
- опишим все этапы работы;
- добавим выводы и дополнительные предложения для бизнеса.